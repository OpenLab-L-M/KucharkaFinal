<body>
  <!-- Background Image -->
  <div id="backgroundos"></div>

  <!-- Main Container with Drawer -->
  <mat-drawer-container class="example-container" autosize>
    <!-- Left Sidebar (Filters) -->
    <mat-drawer #drawer class="example-sidenav" mode="side" [opened]="isSidebarOpen">
      <div class="sidebar-content">
        <!-- Close Button for Mobile -->
        <button mat-icon-button class="close-sidebar-btn" (click)="toggleSidebar()" *ngIf="isMobile">
          <mat-icon>close</mat-icon>
        </button>

        <h2 class="filter-title">Filters <mat-icon>filter_list</mat-icon></h2>

        <!-- Search Bar -->
        <div class="search-container">
          <input
            type="text"
            class="search-input"
            [(ngModel)]="searchBarQuery"
            placeholder="Hľadať Recept"
          />
          <mat-icon class="search-icon">search</mat-icon>
        </div>

        <!-- Filter Options - Two Column Layout -->
        <div class="filter-sections two-column-layout">
          <!-- Left Column -->
          <div class="filter-column">
            <!-- Difficulty Filters -->
            <div class="filter-section">
              <h4 class="filter-subtitle">Náročnosť <mat-icon>timeline</mat-icon></h4>
              <label class="cyberpunk-checkbox">
                <input type="checkbox" value="ľahké" [(ngModel)]="easyChecked" (ngModelChange)="easyChecked = $event" (click)="filterRecipesByDifficulty('ľahké')" (click)="call()" [disabled]="sSearchRecept.includes('pokročilé') || sSearchRecept.includes('náročné')">
                <span class="checkbox-label">ľahké</span>
              </label>
              <label class="cyberpunk-checkbox">
                <input type="checkbox" value="pokročilé" [(ngModel)]="mediumChecked" (ngModelChange)="mediumChecked = $event" (click)="filterRecipesByDifficulty('pokročilé')" (click)="call()" [disabled]="sSearchRecept.includes('ľahké') || sSearchRecept.includes('náročné')">
                <span class="checkbox-label">pokročilé</span>
              </label>
              <label class="cyberpunk-checkbox">
                <input type="checkbox" value="náročné" [(ngModel)]="hardChecked" (ngModelChange)="hardChecked = $event" (click)="filterRecipesByDifficulty('náročné')" (click)="call()" [disabled]="sSearchRecept.includes('pokročilé') || sSearchRecept.includes('ľahké')">
                <span class="checkbox-label">náročné</span>
              </label>
            </div>

            <!-- Dietary Filters -->
            <div class="filter-section">
              <h4 class="filter-subtitle">Dietne <mat-icon>fastfood</mat-icon></h4>
              <label class="cyberpunk-checkbox">
                <input type="checkbox" value="veganske" [(ngModel)]="veganChecked" (ngModelChange)="veganChecked = $event" (click)="filterRecipesByDifficulty('veganske')" (click)="call()">
                <span class="checkbox-label">Veganské</span>
              </label>
              <label class="cyberpunk-checkbox">
                <input type="checkbox" value="vegetarianske" [(ngModel)]="vegetarianChecked" (ngModelChange)="vegetarianChecked = $event" (click)="filterRecipesByDifficulty('vegetarianske')" (click)="call()">
                <span class="checkbox-label">Vegetarianske</span>
              </label>
              <label class="cyberpunk-checkbox">
                <input type="checkbox" value="bezlepkove" [(ngModel)]="bezlepkoveChecked" (ngModelChange)="bezlepkoveChecked = $event" (click)="filterRecipesByDifficulty('bezlepkove')" (click)="call()">
                <span class="checkbox-label">Bezlepkove</span>
              </label>
            </div>

            <!-- Course Filters -->
            <div class="filter-section">
              <h4 class="filter-subtitle">chod <mat-icon>access_alarm</mat-icon></h4>
              <label class="cyberpunk-checkbox">
                <input type="checkbox" value="ranajky" [(ngModel)]="ranajkyChecked" (ngModelChange)="ranajkyChecked = $event" (click)="filterRecipesByDifficulty('ranajky')" (click)="call()" [disabled]="sSearchRecept.includes('polievky')">
                <span class="checkbox-label">Raňajky</span>
              </label>
              <label class="cyberpunk-checkbox">
                <input type="checkbox" value="obedy" [(ngModel)]="obedyChecked" (ngModelChange)="obedyChecked = $event" (click)="filterRecipesByDifficulty('obedy')" (click)="call()">
                <span class="checkbox-label">Obedy</span>
              </label>
              <label class="cyberpunk-checkbox">
                <input type="checkbox" value="vecere" [(ngModel)]="vecereChecked" (ngModelChange)="vecereChecked = $event" (click)="filterRecipesByDifficulty('vecere')" (click)="call()">
                <span class="checkbox-label">Večere</span>
              </label>
            </div>
          </div>

          <!-- Right Column -->
          <div class="filter-column">
            <!-- Course Filters Continued -->
            <div class="filter-section">
              <h4 class="filter-subtitle">Typ <mat-icon>restaurant_menu</mat-icon></h4>
              <label class="cyberpunk-checkbox">
                <input type="checkbox" value="salaty" [(ngModel)]="salatyChecked" (ngModelChange)="salatyChecked = $event" (click)="filterRecipesByDifficulty('salaty')" (click)="call()" [disabled]="sSearchRecept.includes('polievky') || sSearchRecept.includes('natierky')">
                <span class="checkbox-label">Šaláty</span>
              </label>
              <label class="cyberpunk-checkbox">
                <input type="checkbox" value="polievky" [(ngModel)]="soupsChecked" (ngModelChange)="soupsChecked = $event" (click)="filterRecipesByDifficulty('polievky')" (click)="call()" [disabled]="sSearchRecept.includes('ranajky') || sSearchRecept.includes('natierky') || sSearchRecept.includes('salaty')">
                <span class="checkbox-label">Polievky</span>
              </label>
              <label class="cyberpunk-checkbox">
                <input type="checkbox" value="natierky" [(ngModel)]="natierkyChecked" (ngModelChange)="natierkyChecked = $event" (click)="filterRecipesByDifficulty('natierky')" (click)="call()" [disabled]="sSearchRecept.includes('salaty') || sSearchRecept.includes('polievky')">
                <span class="checkbox-label">Nátierky</span>
              </label>
            </div>

            <!-- Preference Filters -->
            <div class="filter-section">
              <h4 class="filter-subtitle">Preferencie <mat-icon>thumb_up</mat-icon></h4>
              <label class="cyberpunk-checkbox1">
                <input type="checkbox" value="cukor" [(ngModel)]="sugarChecked" (ngModelChange)="sugarChecked = $event" (click)="filterRecipesByDifficulty('cukor')" (click)="call()">
                <span class="checkbox-label">Bez cukru</span>
              </label>
              <label class="cyberpunk-checkbox1">
                <input type="checkbox" value="bielkoviny" [(ngModel)]="proteinChecked" (ngModelChange)="proteinChecked = $event" (click)="filterRecipesByDifficulty('bielkoviny')" (click)="call()">
                <span class="checkbox-label">Vysoký obsah bielkovín</span>
              </label>
              <label class="cyberpunk-checkbox1">
                <input type="checkbox" value="sacharidy" [(ngModel)]="carbohydratesChecked" (ngModelChange)="carbohydratesChecked = $event" (click)="filterRecipesByDifficulty('sacharidy')" (click)="call()">
                <span class="checkbox-label">Nízky obsah sacharidov</span>
              </label>
            </div>

            <!-- Time Filters -->
            <div class="filter-section">
              <h4 class="filter-subtitle">Časová náročnosť <mat-icon>av_timer</mat-icon></h4>
              <label class="cyberpunk-checkbox">
                <input type="checkbox" value="do 30 minút" [(ngModel)]="halfHourChecked" (ngModelChange)="halfHourChecked = $event" (click)="filterRecipesByDifficulty('do 30 minút')" (click)="call()">
                <span class="checkbox-label">do 30 minút</span>
              </label>
              <label class="cyberpunk-checkbox">
                <input type="checkbox" value="do 60 minút" [(ngModel)]="hourMinsChecked" (ngModelChange)="hourMinsChecked = $event" (click)="filterRecipesByDifficulty('do 60 minút')" (click)="call()">
                <span class="checkbox-label">do 60 minút</span>
              </label>
              <label class="cyberpunk-checkbox">
                <input type="checkbox" value="do 90 minút" [(ngModel)]="hourAndHalfChecked" (ngModelChange)="hourAndHalfChecked = $event" (click)="filterRecipesByDifficulty('do 90 minút')" (click)="call()">
                <span class="checkbox-label">do 90 minút</span>
              </label>
            </div>
          </div>
        </div>

        <!-- Clear Filters Button -->
        <button mat-button class="shopping-list-filter-button" (click)="filterWindow()">filtruj podľa nákupného zoznamu <mat-icon>shopping_cart</mat-icon></button>
        <button mat-button class="clear-filter-button" (click)="clearFilter()">Clear Filters</button>

      </div>
    </mat-drawer>
    @if(isDataLoaded$ && isDataLoaded$.closed){
    <!-- Main Content Area -->
    <div class="example-sidenav-content">
      <!-- Toggle Sidebar Button for Mobile -->
      <button mat-icon-button class="open-sidebar-btn" (click)="toggleSidebar()" *ngIf="isMobile">
        <mat-icon>filter_list</mat-icon>
      </button>

      <!-- Recipe Cards Container -->
      
      <div class="recipes-container">
        @if(sSearchRecept.length > 0 ||paginatedRecipes().length <= 0){
        @for(recipe of realRecipes() | filter : sSearchRecept : selectedIngredients : searchBarQuery; track recipe; let i = $index){
        <mat-card class="recipes-items" >
          <!-- Recipe Name at the Top -->
           
          <mat-card-title class="recipes-name">
            <span class="recipe-name-text">{{recipe.name}}</span>
          </mat-card-title>

          <!-- Recipe Details (Timer, Portions, Calories) -->
          <div class="recipe-details">
            <!-- Timer -->
            <div class="detail-item">
              <mat-icon class="detail-icon">query_builder</mat-icon>
              <span class="detail-text">{{recipe.cas}} min</span>
            </div>

            <!-- Portions -->
            <div class="detail-item">
              <mat-icon class="detail-icon">restaurant</mat-icon>
              <span class="detail-text">{{recipe.gramaz / 250 | number : '1.0-0'}}</span>
            </div>

            <!-- Calories -->
            <div class="detail-item">
              <mat-icon class="detail-icon">local_fire_department</mat-icon>
              <span class="detail-text">{{recipe.kalorie}} KCal</span>
            </div>

            <!-- Favorite Heart -->
            <div class="favourite-container">
              <input type="checkbox" id="favourite-{{recipe.id}}" class="favourite-checkbox" (click)="ktoryRecept(recipe.id)" [checked]="isFavourite(recipe.id)">
              <label for="favourite-{{recipe.id}}" class="favourite-label">
                <mat-icon class="heart-icon">favorite</mat-icon>
              </label>
            </div>
          </div>

          <!-- Recipe Image - Fills remaining space -->
          <div class="image-container">
            <img mat-card-image [src]="getImage(recipe.id)" class="recipes-images" matTooltip="Details of {{recipe.name}}" [routerLink]="['/RecipesDetails', recipe.id]">
          </div>
        </mat-card>
      }
    }
    @else if(sSearchRecept.length <= 0){
      @for(recipe of paginatedRecipes() | filter : sSearchRecept : selectedIngredients : searchBarQuery; track recipe; let i = $index){
        <mat-card class="recipes-items" >
          <!-- Recipe Name at the Top -->
           
          <mat-card-title class="recipes-name">
            <span class="recipe-name-text">{{recipe.name}}</span>
          </mat-card-title>

          <!-- Recipe Details (Timer, Portions, Calories) -->
          <div class="recipe-details">
            <!-- Timer -->
            <div class="detail-item">
              <mat-icon class="detail-icon">query_builder</mat-icon>
              <span class="detail-text">{{recipe.cas}} min</span>
            </div>

            <!-- Portions -->
            <div class="detail-item">
              <mat-icon class="detail-icon">restaurant</mat-icon>
              <span class="detail-text">{{recipe.gramaz / 250 | number : '1.0-0'}}</span>
            </div>

            <!-- Calories -->
            <div class="detail-item">
              <mat-icon class="detail-icon">local_fire_department</mat-icon>
              <span class="detail-text">{{recipe.kalorie}} KCal</span>
            </div>

            <!-- Favorite Heart -->
            <div class="favourite-container">
              <input type="checkbox" id="favourite-{{recipe.id}}" class="favourite-checkbox" (click)="ktoryRecept(recipe.id)" [checked]="isFavourite(recipe.id)">
              <label for="favourite-{{recipe.id}}" class="favourite-label">
                <mat-icon class="heart-icon">favorite</mat-icon>
              </label>
            </div>
          </div>

          <!-- Recipe Image - Fills remaining space -->
          <div class="image-container">
            <img mat-card-image [src]="getImage(recipe.id)" class="recipes-images" matTooltip="Details of {{recipe.name}}" [routerLink]="['/RecipesDetails', recipe.id]">
          </div>
        </mat-card>
      }
    }
      </div>
      <app-paginator-c
      class="recipe-paginator"
          [length]="totalRecipes()"
          [(pageSize)]="currentPageSize"
          [(pageIndex)]="currentPageIndex"
          (pageChanged)="handlePageEvent($event)"></app-paginator-c>
    </div>

  }

    @else if(isDataLoaded$ && !isDataLoaded$.closed){
      <mat-spinner style="margin: auto; margin-top: 30%;"></mat-spinner>
    }
  </mat-drawer-container>



  <!-- Create Recipe Button -->
  <div class="create">
    <button id="create_link" [routerLink]="['/CreateRecipe']" matTooltip="Create a new recipe">
      <mat-icon>add</mat-icon>
    </button>
  </div>

</body>